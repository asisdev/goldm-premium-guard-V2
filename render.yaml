services:
  - type: web
    name: goldm-premium-guard
    env: python
    plan: free
    autoDeploy: true
    buildCommand: pip install --upgrade pip && pip install --no-cache-dir -r requirements.txt
    startCommand: uvicorn app:app --host 0.0.0.0 --port $PORT
    healthCheckPath: /health
    healthCheckTimeout: 100
    envVars:
      # Strategy
      - key: LOOKBACK_MIN
        value: "5"
      - key: UNDER_MOVE_PCT
        value: "0.20"
      - key: OPT_STALE_PCT
        value: "0.10"
      - key: TOP_K
        value: "5"
      - key: RUN_INTERVAL_S
        value: "60"
      - key: ALERT_SILENCE_MIN
        value: "5"
      # TT (fill in UI)
      - key: TT_WEBHOOK_URL
        sync: false
      - key: TT_API_TOKEN
        sync: false
      # Kotak identity (same you use in Tradetron)
      - key: NEO_MOBILE
        sync: false
      - key: NEO_PASSWORD
        sync: false
      - key: NEO_TOTP_SECRET
        sync: false
      - key: NEO_CLIENT_CODE
        sync: false
      - key: NEO_MPIN
        sync: false
      - key: NEO_ACCESS_TOKEN
        sync: false
      # v2 endpoints (defaults from migration guide)
      - key: NEO_TOTP_LOGIN_URL
        value: "https://mis.kotaksecurities.com/login/1.0/tradeApiLogin"
      - key: NEO_MPIN_VALIDATE_URL
        value: "https://mis.kotaksecurities.com/login/1.0/tradeApiValidate"
      # After validate, we get baseUrl â†’ append these PATHS to it
      - key: NEO_QUOTES_PATH
        value: ""
      - key: NEO_OPTIONCHAIN_PATH
        value: ""
      # Token header config
      - key: NEO_TOKEN_HEADER_KEY
        value: "x-api-token"
      - key: NEO_TOKEN_PREFIX
        value: ""